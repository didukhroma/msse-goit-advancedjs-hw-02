{"version":3,"file":"commonHelpers2.js","sources":["../src/js/02-timer.js"],"sourcesContent":["// Описаний в документації\r\nimport flatpickr from 'flatpickr';\r\nimport iziToast from 'izitoast';\r\n// Додатковий імпорт стилів\r\nimport 'flatpickr/dist/flatpickr.min.css';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n// Refs\r\nconst refs = {\r\n  inputDateRef: document.querySelector('#datetime-picker'),\r\n  btnStartRef: document.querySelector('[data-start]'),\r\n  timerRef: document.querySelector('.timer'),\r\n};\r\n// Timer time\r\nlet timerMs = null;\r\n// Settings for iziToast\r\niziToast.settings({\r\n  iconUrl: './images/warning-icon.png',\r\n  message: 'Please choose a date in the future',\r\n  timeout: 2000,\r\n  position: 'topCenter',\r\n  backgroundColor: 'red',\r\n});\r\n\r\n// Options for flatpickr\r\nconst options = {\r\n  enableTime: true,\r\n  time_24hr: true,\r\n  defaultDate: new Date(),\r\n  minuteIncrement: 1,\r\n  onClose(selectedDates) {\r\n    let dateDiff = selectedDates[0] - this.now;\r\n    if (dateDiff <= 0) {\r\n      iziToast.show();\r\n    } else {\r\n      timerMs = dateDiff;\r\n      enableStartBtn();\r\n    }\r\n  },\r\n};\r\n// Logic\r\ndisableStartBtn();\r\nflatpickr(refs.inputDateRef, options);\r\nrefs.btnStartRef.addEventListener('click', handleClickStart);\r\n//functions\r\n//------------------------\r\nfunction handleClickStart(e) {\r\n  disableStartBtn();\r\n  changeData(convertMs(timerMs));\r\n  let timerId = setInterval(() => {\r\n    timerMs -= 1000;\r\n    if (timerMs <= 0) clearInterval(timerId);\r\n    changeData(convertMs(timerMs));\r\n  }, 1000);\r\n}\r\n\r\nfunction convertMs(ms) {\r\n  // Number of milliseconds per unit of time\r\n  const second = 1000;\r\n  const minute = second * 60;\r\n  const hour = minute * 60;\r\n  const day = hour * 24;\r\n\r\n  // Remaining days\r\n  const days = Math.floor(ms / day);\r\n  // Remaining hours\r\n  const hours = Math.floor((ms % day) / hour);\r\n  // Remaining minutes\r\n  const minutes = Math.floor(((ms % day) % hour) / minute);\r\n  // Remaining seconds\r\n  const seconds = Math.floor((((ms % day) % hour) % minute) / second);\r\n\r\n  return { days, hours, minutes, seconds };\r\n}\r\n\r\nfunction addLeadingZero(value) {\r\n  let strValue = String(value);\r\n  return strValue.length > 1 ? strValue : strValue.padStart(2, '0');\r\n}\r\n\r\nfunction disableStartBtn() {\r\n  refs.btnStartRef.disabled = true;\r\n}\r\nfunction enableStartBtn() {\r\n  refs.btnStartRef.disabled = false;\r\n}\r\n\r\nfunction changeData(data) {\r\n  // all spans from html with class value\r\n  const timerSpanArray = Array.from(refs.timerRef.children)\r\n    .flatMap(el => [...el.children])\r\n    .filter(el => el.classList.contains('value'));\r\n  // find needed span and change text from data\r\n  Object.keys(data).forEach(el => {\r\n    timerSpanArray.find(span =>\r\n      Object.keys(span.dataset).includes(el)\r\n    ).textContent = addLeadingZero(data[el]);\r\n  });\r\n}\r\n"],"names":["refs","timerMs","iziToast","options","selectedDates","dateDiff","enableStartBtn","disableStartBtn","flatpickr","handleClickStart","e","changeData","convertMs","timerId","ms","days","hours","minutes","seconds","addLeadingZero","value","strValue","data","timerSpanArray","el","span"],"mappings":"+IAOA,MAAMA,EAAO,CACX,aAAc,SAAS,cAAc,kBAAkB,EACvD,YAAa,SAAS,cAAc,cAAc,EAClD,SAAU,SAAS,cAAc,QAAQ,CAC3C,EAEA,IAAIC,EAAU,KAEdC,EAAS,SAAS,CAChB,QAAS,4BACT,QAAS,qCACT,QAAS,IACT,SAAU,YACV,gBAAiB,KACnB,CAAC,EAGD,MAAMC,EAAU,CACd,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACjB,QAAQC,EAAe,CACrB,IAAIC,EAAWD,EAAc,GAAK,KAAK,IACnCC,GAAY,EACdH,EAAS,KAAI,GAEbD,EAAUI,EACVC,IAEH,CACH,EAEAC,IACAC,EAAUR,EAAK,aAAcG,CAAO,EACpCH,EAAK,YAAY,iBAAiB,QAASS,CAAgB,EAG3D,SAASA,EAAiBC,EAAG,CAC3BH,IACAI,EAAWC,EAAUX,CAAO,CAAC,EAC7B,IAAIY,EAAU,YAAY,IAAM,CAC9BZ,GAAW,IACPA,GAAW,GAAG,cAAcY,CAAO,EACvCF,EAAWC,EAAUX,CAAO,CAAC,CAC9B,EAAE,GAAI,CACT,CAEA,SAASW,EAAUE,EAAI,CAQrB,MAAMC,EAAO,KAAK,MAAMD,EAAK,KAAG,EAE1BE,EAAQ,KAAK,MAAOF,EAAK,MAAO,IAAI,EAEpCG,EAAU,KAAK,MAAQH,EAAK,MAAO,KAAQ,GAAM,EAEjDI,EAAU,KAAK,MAASJ,EAAK,MAAO,KAAQ,IAAU,GAAM,EAElE,MAAO,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CACxC,CAEA,SAASC,EAAeC,EAAO,CAC7B,IAAIC,EAAW,OAAOD,CAAK,EAC3B,OAAOC,EAAS,OAAS,EAAIA,EAAWA,EAAS,SAAS,EAAG,GAAG,CAClE,CAEA,SAASd,GAAkB,CACzBP,EAAK,YAAY,SAAW,EAC9B,CACA,SAASM,GAAiB,CACxBN,EAAK,YAAY,SAAW,EAC9B,CAEA,SAASW,EAAWW,EAAM,CAExB,MAAMC,EAAiB,MAAM,KAAKvB,EAAK,SAAS,QAAQ,EACrD,QAAQwB,GAAM,CAAC,GAAGA,EAAG,QAAQ,CAAC,EAC9B,OAAOA,GAAMA,EAAG,UAAU,SAAS,OAAO,CAAC,EAE9C,OAAO,KAAKF,CAAI,EAAE,QAAQE,GAAM,CAC9BD,EAAe,KAAKE,GAClB,OAAO,KAAKA,EAAK,OAAO,EAAE,SAASD,CAAE,CACtC,EAAC,YAAcL,EAAeG,EAAKE,EAAG,CAC3C,CAAG,CACH"}