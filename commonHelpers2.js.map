{"version":3,"file":"commonHelpers2.js","sources":["../src/js/02-timer.js"],"sourcesContent":["// Описаний в документації\r\nimport flatpickr from 'flatpickr';\r\nimport iziToast from 'izitoast';\r\n// Додатковий імпорт стилів\r\nimport 'flatpickr/dist/flatpickr.min.css';\r\nimport 'izitoast/dist/css/iziToast.min.css';\r\n\r\n/**\r\n * References Object\r\n *\r\n * @type {{ inputDateRef: HTMLElement | null; btnStartRef: HTMLElement | null; timerRef: HTMLElement | null; }}\r\n * @property {HTMLElement} inputDateRef - HTML Element Input where pick date\r\n * @property {HTMLElement} btnStartRef - HTML Element Button Start\r\n * @property {HTMLElement} timerRef -HTML Element where indicate timer\r\n *\r\n};\r\n */\r\nconst refs = {\r\n  inputDateRef: document.querySelector('#datetime-picker'),\r\n  btnStartRef: document.querySelector('[data-start]'),\r\n  timerRef: document.querySelector('.timer'),\r\n};\r\n\r\n/**\r\n * Initial time\r\n *\r\n * @type {number | null}\r\n *\r\n */\r\nlet timerMs = null;\r\n\r\n/**\r\n * Settings for iziToast\r\n *\r\n * @type {{ title: string; message: string; timeout: number; position: string; backgroundColor: string; }}\r\n * @description Read more about iziToast settings at https://izitoast.marcelodolza.com/\r\n */\r\nconst settingsIziToast = {\r\n  title: 'X',\r\n  message: 'Please choose a date in the future',\r\n  timeout: 2000,\r\n  position: 'topCenter',\r\n  backgroundColor: 'red',\r\n};\r\n/**\r\n * Options for flatpickr\r\n *\r\n * @type {{ enableTime: boolean; time_24hr: boolean; defaultDate: string; minuteIncrement: number; onClose(selectedDates: string): func; }}\r\n * @description Read more about flatpickr options at https://flatpickr.js.org/\r\n *\r\n */\r\nconst options = {\r\n  enableTime: true,\r\n  time_24hr: true,\r\n  defaultDate: new Date(),\r\n  minuteIncrement: 1,\r\n  onClose(selectedDates) {\r\n    let dateDiff = selectedDates[0] - this.now;\r\n    if (dateDiff <= 0) {\r\n      iziToast.show();\r\n    } else {\r\n      timerMs = dateDiff;\r\n      changeDisabledStatus(refs.btnStartRef);\r\n    }\r\n  },\r\n};\r\n\r\n/**iziToast base settings */\r\niziToast.settings(settingsIziToast);\r\n/**Disabled start button */\r\nchangeDisabledStatus(refs.btnStartRef);\r\n/**flatpickr base settings */\r\nflatpickr(refs.inputDateRef, options);\r\n\r\n// Event listeners\r\n/**Start Button */\r\nrefs.btnStartRef.addEventListener('click', handleClickStart);\r\n\r\n// FUNCTIONS\r\n//----------------------------------------------\r\n/**\r\n * Handler click-event on start button. After click disabled input and disabled start button. Every 1 second change time\r\n *\r\n * @param {Event} e click-event\r\n */\r\nfunction handleClickStart(e) {\r\n  changeDisabledStatus(refs.inputDateRef);\r\n  changeDisabledStatus(refs.btnStartRef);\r\n  changeData(convertMs(timerMs));\r\n  let timerId = setInterval(() => {\r\n    timerMs -= 1000;\r\n    if (timerMs <= 1000) {\r\n      clearInterval(timerId);\r\n      changeDisabledStatus(refs.inputDateRef);\r\n    }\r\n    changeData(convertMs(timerMs));\r\n  }, 1000);\r\n}\r\n//----------------------------------------------\r\n\r\n/**\r\n * Converting input miliseconds to object with properties days, hours, minutes and seconds\r\n *\r\n * @param {number} ms\r\n * @returns {{ days: number; hours: number; minutes: number; seconds: number; }}\r\n */\r\nfunction convertMs(ms) {\r\n  // Number of milliseconds per unit of time\r\n  const second = 1000;\r\n  const minute = second * 60;\r\n  const hour = minute * 60;\r\n  const day = hour * 24;\r\n\r\n  // Remaining days\r\n  const days = Math.floor(ms / day);\r\n  // Remaining hours\r\n  const hours = Math.floor((ms % day) / hour);\r\n  // Remaining minutes\r\n  const minutes = Math.floor(((ms % day) % hour) / minute);\r\n  // Remaining seconds\r\n  const seconds = Math.floor((((ms % day) % hour) % minute) / second);\r\n\r\n  return { days, hours, minutes, seconds };\r\n}\r\n//----------------------------------------------\r\n\r\n/**\r\n * Converting input value to string and if number less than 10 add before value symbol 0. If typeof value !== number function returns string \"XX\"\r\n *\r\n * @param {number} value\r\n * @returns {string}\r\n */\r\nfunction addLeadingZero(value) {\r\n  if (typeof value !== 'number') return 'XX';\r\n  const strValue = String(value);\r\n  return strValue.length > 1 ? strValue : strValue.padStart(2, '0');\r\n}\r\n\r\n//----------------------------------------------\r\n/**\r\n * Change disabled status in HTML element\r\n *\r\n * @param {HTMLElement} element\r\n */\r\nfunction changeDisabledStatus(element) {\r\n  element.disabled = !element.disabled;\r\n}\r\n\r\n//----------------------------------------------\r\n/**\r\n * Change data in HTML elements where indicate timer\r\n *\r\n * @param {object} data\r\n */\r\nfunction changeData(data) {\r\n  // all spans from html with class value\r\n  const timerSpanArray = Array.from(refs.timerRef.children)\r\n    .flatMap(el => [...el.children])\r\n    .filter(el => el.classList.contains('value'));\r\n  // find needed span and change text from data\r\n  Object.keys(data).forEach(el => {\r\n    timerSpanArray.find(span =>\r\n      Object.keys(span.dataset).includes(el)\r\n    ).textContent = addLeadingZero(data[el]);\r\n  });\r\n}\r\n"],"names":["refs","timerMs","settingsIziToast","options","selectedDates","dateDiff","iziToast","changeDisabledStatus","flatpickr","handleClickStart","e","changeData","convertMs","timerId","ms","days","hours","minutes","seconds","addLeadingZero","value","strValue","element","data","timerSpanArray","el","span"],"mappings":"+IAiBA,MAAMA,EAAO,CACX,aAAc,SAAS,cAAc,kBAAkB,EACvD,YAAa,SAAS,cAAc,cAAc,EAClD,SAAU,SAAS,cAAc,QAAQ,CAC3C,EAQA,IAAIC,EAAU,KAQd,MAAMC,EAAmB,CACvB,MAAO,IACP,QAAS,qCACT,QAAS,IACT,SAAU,YACV,gBAAiB,KACnB,EAQMC,EAAU,CACd,WAAY,GACZ,UAAW,GACX,YAAa,IAAI,KACjB,gBAAiB,EACjB,QAAQC,EAAe,CACrB,IAAIC,EAAWD,EAAc,GAAK,KAAK,IACnCC,GAAY,EACdC,EAAS,KAAI,GAEbL,EAAUI,EACVE,EAAqBP,EAAK,WAAW,EAExC,CACH,EAGAM,EAAS,SAASJ,CAAgB,EAElCK,EAAqBP,EAAK,WAAW,EAErCQ,EAAUR,EAAK,aAAcG,CAAO,EAIpCH,EAAK,YAAY,iBAAiB,QAASS,CAAgB,EAS3D,SAASA,EAAiBC,EAAG,CAC3BH,EAAqBP,EAAK,YAAY,EACtCO,EAAqBP,EAAK,WAAW,EACrCW,EAAWC,EAAUX,CAAO,CAAC,EAC7B,IAAIY,EAAU,YAAY,IAAM,CAC9BZ,GAAW,IACPA,GAAW,MACb,cAAcY,CAAO,EACrBN,EAAqBP,EAAK,YAAY,GAExCW,EAAWC,EAAUX,CAAO,CAAC,CAC9B,EAAE,GAAI,CACT,CASA,SAASW,EAAUE,EAAI,CAQrB,MAAMC,EAAO,KAAK,MAAMD,EAAK,KAAG,EAE1BE,EAAQ,KAAK,MAAOF,EAAK,MAAO,IAAI,EAEpCG,EAAU,KAAK,MAAQH,EAAK,MAAO,KAAQ,GAAM,EAEjDI,EAAU,KAAK,MAASJ,EAAK,MAAO,KAAQ,IAAU,GAAM,EAElE,MAAO,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,EAAS,QAAAC,CAAO,CACxC,CASA,SAASC,EAAeC,EAAO,CAC7B,GAAI,OAAOA,GAAU,SAAU,MAAO,KACtC,MAAMC,EAAW,OAAOD,CAAK,EAC7B,OAAOC,EAAS,OAAS,EAAIA,EAAWA,EAAS,SAAS,EAAG,GAAG,CAClE,CAQA,SAASd,EAAqBe,EAAS,CACrCA,EAAQ,SAAW,CAACA,EAAQ,QAC9B,CAQA,SAASX,EAAWY,EAAM,CAExB,MAAMC,EAAiB,MAAM,KAAKxB,EAAK,SAAS,QAAQ,EACrD,QAAQyB,GAAM,CAAC,GAAGA,EAAG,QAAQ,CAAC,EAC9B,OAAOA,GAAMA,EAAG,UAAU,SAAS,OAAO,CAAC,EAE9C,OAAO,KAAKF,CAAI,EAAE,QAAQE,GAAM,CAC9BD,EAAe,KAAKE,GAClB,OAAO,KAAKA,EAAK,OAAO,EAAE,SAASD,CAAE,CACtC,EAAC,YAAcN,EAAeI,EAAKE,EAAG,CAC3C,CAAG,CACH"}